var sample = '{"meals":[{"idMeal":"52823","strMeal":"Salmon Prawn Risotto","strDrinkAlternate":null,"strCategory":"Seafood","strArea":"Italian","strInstructions":"Melt the butter in a thick-based pan and gently cook the onion without colour until it is soft.\r\nAdd the rice and stir to coat all the grains in the butter\r\nAdd the wine and cook gently stirring until it is absorbed\r\nGradually add the hot stock, stirring until each addition is absorbed. Keep stirring until the rice is tender\r\nSeason with the lemon juice and zest, and pepper to taste. (there will probably be sufficient saltiness from the salmon to not need to add salt) Stir gently to heat through\r\nServe scattered with the Parmesan and seasonal vegetables.\r\nGrill the salmon and gently place onto the risotto with the prawns and asparagus","strMealThumb":"https://www.themealdb.com/images/media/meals/xxrxux1503070723.jpg","strTags":"Fish","strYoutube":"https://www.youtube.com/watch?v=V2PMvBv52IE","strIngredient1":"butter","strIngredient2":"onion","strIngredient3":"rice","strIngredient4":"white wine","strIngredient5":"vegetable stock","strIngredient6":"lemon","strIngredient7":"King Prawns","strIngredient8":"salmon","strIngredient9":"asparagus","strIngredient10":"black pepper","strIngredient11":"Parmesan","strIngredient12":"","strIngredient13":"","strIngredient14":"","strIngredient15":"","strIngredient16":"","strIngredient17":"","strIngredient18":"","strIngredient19":"","strIngredient20":"","strMeasure1":"50g/2oz","strMeasure2":"1 finely chopped ","strMeasure3":"150g","strMeasure4":"125ml ","strMeasure5":"1 litre hot","strMeasure6":"The juice and zest of one","strMeasure7":"240g large","strMeasure8":"150g","strMeasure9":"100g tips blanched briefly in boiling water","strMeasure10":"ground","strMeasure11":"50g shavings","strMeasure12":"","strMeasure13":"","strMeasure14":"","strMeasure15":"","strMeasure16":"","strMeasure17":"","strMeasure18":"","strMeasure19":"","strMeasure20":"","strSource":"http://www.rangemaster.co.uk/rangemaster-owners/recipes-ideas-inspiration/recipes/mains/prawn-and-hot-smoked-salmon-risotto-with-asparagus","dateModified":null}]}';

var dinnerMeals = ['{"meals":[{  "idMeal":"0",  "strMeal":"Salad bar",  "strInstructions":"Place ingredients into individual bowls. Everyone makes their own salad. ",  "strMealThumb":" https://thumbs.dreamstime.com/b/greek-salad-bowl-29136411.jpg",  "strYoutube":" ",  "strIngredient1":"Lettuce","strIngredient2":"Shredded cheese","strIngredient3":"Cucumber","strIngredient4":"Tomatoes","strIngredient5":"Carrots","strIngredient6":"Peppers","strIngredient7":"Olives","strIngredient8":"Cottage cheese","strIngredient9":"Hard-boiled eggs","strIngredient10":"Bacon bits","strIngredient11":"Avocado","strIngredient12":"Salad dressing","strIngredient13":"","strIngredient14":"","strIngredient15":"","strIngredient16":"","strIngredient17":"","strIngredient18":"","strIngredient19":"","strIngredient20":"",  "strMeasure1":" ","strMeasure2":"One","strMeasure3":"One","strMeasure4":"3","strMeasure5":" ","strMeasure6":" ","strMeasure7":" ","strMeasure8":" ","strMeasure9":" ","strMeasure10":" ","strMeasure11":" ","strMeasure12":" ","strMeasure13":" ","strMeasure14":" ","strMeasure15":" ","strMeasure16":" ","strMeasure17":" ","strMeasure18":" ","strMeasure19":" ","strMeasure20":" ",  "strSource":" ",  "dateModified":null}]}', 
 
'{"meals":[{  "idMeal":"1",  "strMeal":"Taco soup",  "strInstructions":"Cook the ground beef with the onion. Add the rest of the ingredients, undrained. Stir together. Heat, and serve with chips and sour cream.",  "strMealThumb":"https://thumbs.dreamstime.com/b/taco-soup-condiments-23213568.jpg",  "strYoutube":" ",  "strIngredient1":"Ground beef","strIngredient2":"Onion","strIngredient3":"Tomato sauce","strIngredient4":"Tomatoes","strIngredient5":"Black beans","strIngredient6":"Diced green chili’s","strIngredient7":"Corn","strIngredient8":"Taco seasoning","strIngredient9":"chips","strIngredient10":"sour cream","strIngredient11":"","strIngredient12":"","strIngredient13":"","strIngredient14":"","strIngredient15":"","strIngredient16":"","strIngredient17":"","strIngredient18":"","strIngredient19":"","strIngredient20":"",  "strMeasure1":"1 pound","strMeasure2":"1 Chopped","strMeasure3":"2 - 8 oz cans of","strMeasure4":"2 cans of","strMeasure5":"1 can of","strMeasure6":"1 can of","strMeasure7":"1 can of","strMeasure8":"1 packet of","strMeasure9":"1 bag","strMeasure10":" ","strMeasure11":" ","strMeasure12":" ","strMeasure13":" ","strMeasure14":" ","strMeasure15":" ","strMeasure16":" ","strMeasure17":" ","strMeasure18":" ","strMeasure19":" ","strMeasure20":" ",  "strSource":" ",  "dateModified":null}]}',
 
'{"meals":[{  "idMeal":"2",  "strMeal":"Chicken, Rice, and Broccoli",  "strInstructions":"Pour rice into a greased 9x13 pan. Place chicken onto of rice. Place broccoli on top. Mix together the remaining ingredients (minus cheese). Spoon the mixture on top. Add 3 cups of water. Cover with foil. Bake at 350ᵒ for an hour.",  "strMealThumb":"https://thumbs.dreamstime.com/b/broccoli-green-peas-cauliflower-cheese-casserole-oven-dish-top-view-vegan-vegetable-nutritional-yeast-144846577.jpg",  "strYoutube":" ",  "strIngredient1":"Chicken","strIngredient2":"Rice","strIngredient3":"Broccoli","strIngredient4":"Cream of Chicken soup","strIngredient5":"curry","strIngredient6":"mayonnaise","strIngredient7":"yogurt","strIngredient8":"Lemon juice","strIngredient9":"Shredded cheese","strIngredient10":"","strIngredient11":"","strIngredient12":"","strIngredient13":"","strIngredient14":"","strIngredient15":"","strIngredient16":"","strIngredient17":"","strIngredient18":"","strIngredient19":"","strIngredient20":"",  "strMeasure1":"1 pound","strMeasure2":"1½ cups","strMeasure3":"1 pound","strMeasure4":"2 cans","strMeasure5":"2 tsp","strMeasure6":"½ cup","strMeasure7":"½ cup","strMeasure8":"1 Tbsp","strMeasure9":"2 cups","strMeasure10":" ","strMeasure11":" ","strMeasure12":" ","strMeasure13":" ","strMeasure14":" ","strMeasure15":" ","strMeasure16":" ","strMeasure17":" ","strMeasure18":" ","strMeasure19":" ","strMeasure20":" ",  "strSource":" ",  "dateModified":null}]}',

'{"meals":[{  "idMeal":"3",  "strMeal":"Burritos",  "strInstructions":"Prepare all ingredients in individual containers. Serve buffet-style; everyone fills their own tortilla.",  "strMealThumb":"https://thumbs.dreamstime.com/b/veggie-wrap-isolated-vegetable-wrap-white-111438793.jpg",  "strYoutube":" ",   "strIngredient1":"Rice","strIngredient2":"Black beans","strIngredient3":"Shredded cheese","strIngredient4":"Sour cream","strIngredient5":"Salsa","strIngredient6":"Guacamole","strIngredient7":"Olives","strIngredient8":"Tomatoes","strIngredient9":"Shredded Lettuce","strIngredient10":"Tortillas","strIngredient11":"","strIngredient12":"","strIngredient13":"","strIngredient14":"","strIngredient15":"","strIngredient16":"","strIngredient17":"","strIngredient18":"","strIngredient19":"","strIngredient20":"",  "strMeasure1":"2 cups","strMeasure2":"1 can","strMeasure3":" ","strMeasure4":"1","strMeasure5":"1 can ","strMeasure6":" ","strMeasure7":"1 can sliced","strMeasure8":"1 can diced","strMeasure9":" ","strMeasure10":"10","strMeasure11":" ","strMeasure12":" ","strMeasure13":" ","strMeasure14":" ","strMeasure15":" ","strMeasure16":" ","strMeasure17":" ","strMeasure18":" ","strMeasure19":" ","strMeasure20":" ",  "strSource":" ",  "dateModified":null}]}',

'{"meals":[{  "idMeal":"4",  "strMeal":"Tuna Roll",  "strInstructions":"Mix together crust (flour, salt, butter) until it forms a sticky dough. Roll out into a flat rectangle. In a saucepan add onions and butter. Cook until the onions are brown. Then mix in flour until it is consistent. Then add milk, salt, marjoram, and thyme. Let it thicken. Stir in tuna, parsley, and a beaten egg minus 1 Tbsp. After the mixture is cooked, spoon it into the crust. Roll the crust, seal the seam. Place the roll onto a greased cookie sheet with the seam down. Brush 1 Tbsp egg. Bake @ 400ᵒ for 30-35 minutes.",  "strMealThumb":"https://thumbs.dreamstime.com/b/chicken-parmigiana-roll-traditional-italian-sauce-59492367.jpg",  "strYoutube":" ",   "strIngredient1":"Flour","strIngredient2":"Salt","strIngredient3":"Butter","strIngredient4":"Onion","strIngredient5":"Butter","strIngredient6":"Flour","strIngredient7":"Evaporated Milk","strIngredient8":"Salt","strIngredient9":"Marjoram","strIngredient10":"Thyme","strIngredient11":"Tuna","strIngredient12":"Parsley","strIngredient13":"Egg","strIngredient14":"","strIngredient15":"","strIngredient16":"","strIngredient17":"","strIngredient18":"","strIngredient19":"","strIngredient20":"",  "strMeasure1":"1 cup","strMeasure2":"½ tsp","strMeasure3":"⅓ cup","strMeasure4":"2 Tbsp","strMeasure5":"2 Tbsp","strMeasure6":"1 Tbsp","strMeasure7":"¼ cup","strMeasure8":"¼ tsp","strMeasure9":"⅛ tsp","strMeasure10":"⅛ tsp","strMeasure11":"1 can, drained","strMeasure12":"a dash","strMeasure13":"1","strMeasure14":" ","strMeasure15":" ","strMeasure16":" ","strMeasure17":" ","strMeasure18":" ","strMeasure19":" ","strMeasure20":" ",  "strSource":" ",  "dateModified":null}]}',

'{"meals":[{  "idMeal":"5",  "strMeal":"Fettuccine Alfredo",  "strInstructions":"1. Chop the cauliflower. Bring the vegetable broth to a boil over medium high heat and add cauliflower. Cook until cauliflower is soft, about 15 minutes. In my experience, the longer you cook it, the smoother the sauce will be. Meanwhile, melt the butter in a large skillet over medium heat. Add the minced garlic and saute for 4-5 minutes or until soft and fragrant. 2. As the garlic and cauliflower are cooking, bring a large pot of water to boil and cook the fettuccine according to directions on package, reserving some of the starchy water to add to the sauce later. 3. Transfer cauliflower to a blender with about 2 cups of the broth. You may need to do this in batches depending on the size of your blender. Add the sauteed garlic, salt, nutmeg, and black pepper and puree until very smooth, about 5 minutes. Once the mixture is moving, stream the olive oil into the blender. Add more broth or water if the mixture is too thick to move through the blender. You want it to turn through the blender easily. When puree is very smooth, transfer back to the butter/garlic skillet. 4. Add the cream and cook over low heat. Add the starchy pasta water (or regular water if you’re not making pasta) and keep warm until ready to serve. Combine noodles and sauce in a large pot or skillet and serve immediately.",  "strMealThumb":"https://thumbs.dreamstime.com/b/fettuccine-alfredo-thyme-rustic-table-30981504.jpg",  "strYoutube":" ",   "strIngredient1":"Fettuccine","strIngredient2":"Cauliflower","strIngredient3":"Vegetable broth","strIngredient4":"Garlic","strIngredient5":"Butter","strIngredient6":"Salt","strIngredient7":"Nutmeg","strIngredient8":"Black pepper","strIngredient9":"Olive oil","strIngredient10":"Heavy cream","strIngredient11":"water","strIngredient12":"","strIngredient13":"","strIngredient14":"","strIngredient15":"","strIngredient16":"","strIngredient17":"","strIngredient18":"","strIngredient19":"","strIngredient20":"",  "strMeasure1":"1 lb","strMeasure2":"3 heads","strMeasure3":"6 cups","strMeasure4":"6 cloves","strMeasure5":"1 Tbsp","strMeasure6":"1 tsp","strMeasure7":"1 pinch","strMeasure8":"1 pinch","strMeasure9":"1 Tbsp","strMeasure10":"¼ cup","strMeasure11":"1 cup","strMeasure12":" ","strMeasure13":" ","strMeasure14":" ","strMeasure15":" ","strMeasure16":" ","strMeasure17":" ","strMeasure18":" ","strMeasure19":" ","strMeasure20":" ",  "strSource":"https://pinchofyum.com/healthy-fettucine-alfredo",  "dateModified":null}]}',

'{"meals":[{  "idMeal":"6",  "strMeal":"Sweet Chili",  "strInstructions":"In a large stock pot cook 4-6 slices of cut up bacon over medium high heat until it looks about half way done – just about 2-3 minutes. Add a chopped pepper (any color) to the bacon and continue to cook another 3-4 minutes, stirring occasionally. Add 1 lb ground beef and continue to cook until book is thoroughly cooked. Now add the remaining ingredients and continue cooking until heated thoroughly, about 7-8 more minutes. Serve with cornbread or chips. ",  "strMealThumb":"https://thumbs.dreamstime.com/b/chili-homemade-beans-homemade-chili-kidney-beans-fire-roasted-tomatoes-onions-hot-peppers-ground-beef-ground-turkey-106480462.jpg",  "strYoutube":" ",   "strIngredient1":"Bacon","strIngredient2":"Ground beef","strIngredient3":"Sweet pepper","strIngredient4":"Tomato sauce","strIngredient5":"Brown sugar","strIngredient6":"Dry mustard","strIngredient7":"Baked beans","strIngredient8":"Salt","strIngredient9":"Ground pepper","strIngredient10":"corn","strIngredient11":"scoop chips","strIngredient12":"","strIngredient13":"","strIngredient14":"","strIngredient15":"","strIngredient16":"","strIngredient17":"","strIngredient18":"","strIngredient19":"","strIngredient20":"",  "strMeasure1":"6-8 strips","strMeasure2":"1 lb","strMeasure3":"1 large chopped","strMeasure4":"33 oz","strMeasure5":"¼ cup","strMeasure6":"1 tsp","strMeasure7":"2 cans","strMeasure8":"1 tsp","strMeasure9":"½ tsp","strMeasure10":"1-2 cans","strMeasure11":"1 bag","strMeasure12":" ","strMeasure13":" ","strMeasure14":" ","strMeasure15":" ","strMeasure16":" ","strMeasure17":" ","strMeasure18":" ","strMeasure19":" ","strMeasure20":" ",  "strSource":" ",  "dateModified":null}]}' 
];


var ids = [ "52823", "52811", "52869", "52876", "52937", "52841", "52962", "52945"];
// var ids = ["1", "2"];

function displayDinner(index) {
  var day = new Date(); 
  var sunday = parseInt(localStorage.sunday);

  // //set sunday value
  // if (localStorage.sunday) { 
  // } else { 
  //   localStorage.setItem('sunday', day.getDate() - day.getDay())
  // }

  // //reset sunday value, if needed
  // if (localStorage.sunday > day.getDate() || localStorage.sunday > day.getDate() + 6) { 
  //   localStorage.setItem('sunday', day.getDate() - day.getDay())
  // }
 

  //get the dinner meal 
  storeAMeal((dinnerMeals[(parseInt(sunday) + parseInt(index)) % dinnerMeals.length]), index);

  //the api url
    // console.log("index " + index);
    // console.log("array value " + (parseInt(index) + parseInt(sunday)) % ids.length);
    // console.log("ids[i] " + ids[(parseInt(index) + parseInt(sunday)) % ids.length]);
    // var requestURL = 'https://www.themealdb.com/api/json/v1/1/lookup.php?i=' + ids[(parseInt(index) + parseInt(sunday)) % ids.length];
    // //create a dinner object
    // var xhttp = new XMLHttpRequest();
    // xhttp.onreadystatechange = function() {
    //   if (this.readyState == 4 && this.status == 200) { 
    //     var dinner = xhttp.response;
    //     storeAMeal(dinner, index);
    //   }
    // }
    
    // xhttp.open('GET', requestURL);
    // xhttp.responseType = 'json';
    // xhttp.send();
};


//stores the API information into a javaScript object, displays the object, and stores it in localStorage 
function storeAMeal(dinnerMeal, index) { 
  var dinner = JSON.parse(dinnerMeal);

  //create a meal object
  var meal = { 
    id: dinner.meals[0].idMeal, 
    name: dinner.meals[0].strMeal,
    cookDirections: dinner.meals[0].strInstructions,
    youtubeLink: dinner.meals[0].strYoutube,
    picture: dinner.meals[0].strMealThumb,

    ingredPortions: [
      dinner.meals[0].strMeasure1,
      dinner.meals[0].strMeasure2,
      dinner.meals[0].strMeasure3,
      dinner.meals[0].strMeasure4,
      dinner.meals[0].strMeasure5,
      dinner.meals[0].strMeasure6,
      dinner.meals[0].strMeasure7,
      dinner.meals[0].strMeasure8,
      dinner.meals[0].strMeasure9,
      dinner.meals[0].strMeasure10,
      dinner.meals[0].strMeasure11,
      dinner.meals[0].strMeasure12,
      dinner.meals[0].strMeasure13,
      dinner.meals[0].strMeasure14,
      dinner.meals[0].strMeasure15,
      dinner.meals[0].strMeasure16,
      dinner.meals[0].strMeasure17,
      dinner.meals[0].strMeasure18,
      dinner.meals[0].strMeasure19,
      dinner.meals[0].strMeasure20      
    ],
    ingredient: [
      dinner.meals[0].strIngredient1,
      dinner.meals[0].strIngredient2,
      dinner.meals[0].strIngredient3,
      dinner.meals[0].strIngredient4,
      dinner.meals[0].strIngredient5,
      dinner.meals[0].strIngredient6,
      dinner.meals[0].strIngredient7,
      dinner.meals[0].strIngredient8,
      dinner.meals[0].strIngredient9,
      dinner.meals[0].strIngredient10,
      dinner.meals[0].strIngredient11,
      dinner.meals[0].strIngredient12,
      dinner.meals[0].strIngredient13,
      dinner.meals[0].strIngredient14,
      dinner.meals[0].strIngredient15,
      dinner.meals[0].strIngredient16,
      dinner.meals[0].strIngredient17,
      dinner.meals[0].strIngredient18,
      dinner.meals[0].strIngredient19,
      dinner.meals[0].strIngredient20
    ],

    //object method
    getIngredients: function() { 
      var myDiv = document.createElement('ul');
      var dayDin = document.getElementsByClassName('dinner');

      for (i = 0; i < this.ingredient.length; i++) { 
        if (this.ingredient[i].length > 1) { 
          var item = document.createElement('li');
          item.textContent = this.ingredPortions[i] + " " + this.ingredient[i];
          myDiv.appendChild(item);
        }
      }
      dayDin[index].appendChild(myDiv);
    }

  }
  console.log(meal);
  sessionStorage.setItem(dinner.meals[0].strMeal, JSON.stringify(meal));
  addAMeal(meal, index);
};

//add a meal to the DOM
function addAMeal(dinner, index) {
  //create object
  var din = document.getElementsByClassName('dinner');
  
    //create a div
    var myDiv = document.createElement('div');
    //create a header, background image, a link, and some text 
    var myH2 = document.createElement('h2');
    din[index].style.backgroundImage = "url("+dinner.picture+")";
    din[index].style.backgroundSize = "cover";

    var myPara1 = document.createElement('p');
    var myPara2 = document.createElement('a');
    var myPara3 = document.createElement('p');

    myH2.textContent = dinner.name;
    myPara1.textContent = 'id: ' + dinner.id;
    myPara2.textContent = 'Youtube';
    myPara2.setAttribute('href', dinner.youtubeLink);
    myPara2.setAttribute('target', '_blank');
    myPara3.textContent = 'Directions: ' + dinner.cookDirections;

    //attach the newly created elements to the parent element
    myDiv.appendChild(myH2);
    //myDiv.appendChild(myPara1);
    myDiv.appendChild(myPara3);
    myDiv.appendChild(myPara2);
    din[index].appendChild(myDiv);

    //add ingredients
    var myPara4 = document.createElement('p');
    myPara4.textContent = "Ingredients:";
    myDiv.appendChild(myPara4);
    dinner.getIngredients();

}
